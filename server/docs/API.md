# API документация

Описание апи вызовов и примеры работы с ними.

## Ссылки

- [Инструкция по установке](../README.md)
- [Лог изменений](./CHANGELOG.md)
- [Инструкция для разработчика](./CONTRIBUTING.md)

## Языковые настройки

Для получения сообщения ответа от сервера на нужном языке, передаем заголовок `lang` с названием локали `en | ru | uk`. **На момент написания этого документа, все файлы локалей пока на английском `src/locales`**

## Авторизация

После аутентификациии по почте и паролю, или при регистрации, или при смене пароля, выдается `token`, который необходимо передавать в заголовке `Authorization` **каждого запроса требующего авторизации**:

```JSON
"Authorization" : "Bearer token"
```

## API вызовы

Чтобы не клонировать сюда одно и тоже, и держать API документацию всегда в актуальном состоянии, здесь приведены ссылки на файлы, которых должно хватить для фронтенд разработчика.

- Файлы директории [rest/remote](../rest/remote) - содержат примеры запросов на апи, также там есть запросы, которые не отражены в `api.d.ts` - потому что в нем только запросы по апи призма, а есть запросы, например по пользователю, где протоколы запроса не соответствую апи призма. **Локации файлов в `rest/remote` соответствуют апи на который ссылается файл, например: `/api/v1/user/findfirst` => `rest/user/findfirst.http`**.
- Файл [src/api/api.d.ts](../src/api/api.d.ts) - содержит объявления типизированных методов без реализации, с песочницей (при использовании IDE VSCode).
- Файл [src/index.js](../src/index.js) если предыдущих двух файлов недостаточно для понимания, например правил авторизации, можно посмотреть этот файл, особенно если есть какой-нибудь опыт с `ExpressJS`.
- Файлы обработчиков запроса при нажатии в `src/index.ts` на `Ctrl+L Mouse` по обработчику запроса, например `user.findFirst` откроется обработчик и в интерфейсе обработчика `Args`, вверху файла, можно увидеть актуальный тип ожидаемых параметров.

## Результаты ответов

```typescript
// статусы для определения получены ли данные и для окрашивания сообщений,
// например: зеленый | желтый | красный.
type Status = 'error' | 'warning' | 'success';

interface Result<T> {
  status: Status; // Если статус success значит данные получены иначе data === null
  message: string; // Сообщение которое можно выводить пользователю на его языке
  data: null | T; // T - тип запрашиваемой модели
  stdErrMessage?: string; // Только в дев режиме для понимания что произошло
  code?: string; // Там где нужно быстро понять в чем причина, например email, чтобы подсветить пользователю нужное поле
  token?: string;
}
```
